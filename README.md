ModelHeader
===========

This program turns your 3D models into C header files! You can use them as-is
and write your own loader, or also use the header-only loader compatible with
OpenGL and OpenGL ES. Textures or materials are _not_ written to the headers;
only mesh data. Texture file names, however, are provided.

# Generator

The generator part is written using C++17.

## Dependencies

[Assimp](http://www.assimp.org/) is the only mandatory dependency. It is needed
for the header generator.

## Building

To build the project using the [Meson build system](https://mesonbuild.com/),
run the following commands:

```sh
meson build
ninja -C build
```

The resulting executable is `build/modelheader`.

## Usage

```sh
modelheader model_file
```

This writes the output header to stdout, which you can then forward to where
you want it. Example:

```sh
modelheader model_file > my_model.h
```

By default, all primitives are pre-transformed by their transform matrices. If
you don't want this, use the `-p` flag.

If you wish to use the generated header manually, here's an example:

```c
#include "my_model.h"

/* In this example, the model data is now readable in the following variables.
 *
 * float my_model_vertices[my_model_vertex_stride*my_model_vertex_count]; 
 * unsigned my_model_indices[my_model_index_count];
 * struct modelheader_primitive my_model_primitives[my_model_primitive_count];
 *
 * Offsets of the vertex attributes inside a vertex are available as follows:
 *
 * my_model_position_offset
 * my_model_normal_offset
 * my_model_uv0_offset
 *
 * Primitives and optionally their matrix transforms are available through
 * my_model_primitives. See the header for the definition of
 * modelheader_primitive.
 */
```

# OpenGL Loader library

The loader library is written using C99 inline functions. It is entirely
contained in `model_header_gl.h`.

## Dependencies

The only dependency is whichever OpenGL version you wish to use, as long as it's
newer than OpenGL 2.1 (VBOs are used at minimum).

## Usage

Include the OpenGL headers you need before including `model_header_gl.h`. This
because the header attempts to stay as portable as possible.

Vertex array objects are generated by default. This requires OpenGL 3.0 or
newer. If you wish to use older versions, define `MODELHEADER_DISABLE_VAO`
before including the header.

Example:

```c
// Include your OpenGL headers. If you use GLEW, this is how you do it.
#include <GL/glew.h>
// Uncomment the below line if you are using older than OpenGL 3.0
// #define MODELHEADER_DISABLE_VAO
#include "model_header_gl.h"

// You can also include your model before model_header_hl.h, it doesn't matter.
#include "my_model.h"

...

GLuint my_vbo, my_ibo, my_vao;

// Define the attribute locations used in your shader
GLuint locations[] = {
    MODELHEADER_POS, 0,
    MODELHEADER_NORMAL, 1,
    MODELHEADER_UV0, 2,
    0 // Or MODELHEADER_ATTRIB_END, whichever you deem more readable.
};

// To load the model with VAOs enabled: (note lack of quotes around my_model)
model_header_gl_load_vao(my_model, &my_vbo, &my_ibo, &my_vao, locations);
/* You can also leave the locations array as NULL. Then the locations will be
 * as follows:
 *
 * Position - 0
 * Normals  - 1
 * UV0      - 2
 */

// To load the model without a VAO:
model_header_gl_load(my_model, &my_vbo, &my_ibo);
// To set vertex attribs without a VAO: (locations can be NULL here, see above)
model_header_gl_set_vertex_attribs(my_model, locations);

/* Similar to manual handling, primitive information is found through
 * my_model_primitives. This information is only useful if you wish to
 * handle primitives separately, for example for materials or transforms.
 */
```
